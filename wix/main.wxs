<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Name='Tetris Synthwave' 
           Id='*' 
           UpgradeCode='F0B9E4B6-7E6E-4E8C-9A70-08E44B7D8D47'
           Manufacturer='Tetris Synthwave'
           Language='1033' 
           Codepage='1252' 
           Version='$(var.Version)'>
    
    <Package Id='*'
             Keywords='Installer'
             Description='Tetris Synthwave Installer'
             Manufacturer='Tetris Synthwave'
             InstallerVersion='300' 
             Languages='1033' 
             Compressed='yes' 
             SummaryCodepage='1252'
             />

    <MajorUpgrade Schedule='afterInstallInitialize'
                  DowngradeErrorMessage='A later version of [ProductName] is already installed. Setup will now exit.' />

    <Media Id='1' 
           Cabinet='tetris.cab' 
           EmbedCab='yes' 
           DiskPrompt='CD-ROM #1' />
    
    <Property Id='DiskPrompt' 
              Value='Tetris Synthwave Installation [1]' />

    <Icon Id='ApplicationIcon' SourceFile='assets/Icon/Icon.ico' />
    <Property Id='ARPPRODUCTICON' Value='ApplicationIcon' />

    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id='ProgramFiles64Folder'>
        <Directory Id='APPLICATIONFOLDER' Name='TetrisSynthwave'>
          <Component Id='binary0' Guid='*' Win64='yes'>
            <File Id='exe0' 
                  Name='tetris-synthwave.exe' 
                  DiskId='1' 
                  Source='target/x86_64-pc-windows-msvc/release/tetris-synthwave.exe' 
                  KeyPath='yes' />
          </Component>
          
          <Component Id='ApplicationShortcut' Guid='*' Win64='yes'>
            <Shortcut Id='ApplicationStartMenuShortcut'
                      Name='Tetris Synthwave'
                      Description='A modern, minimal, synthwave-themed desktop Tetris'
                      Target='[APPLICATIONFOLDER]tetris-synthwave.exe'
                      WorkingDirectory='APPLICATIONFOLDER'
                      Icon='ApplicationIcon'
                      IconIndex='0'
                      Directory='ProgramMenuFolder' />
            <Shortcut Id='ApplicationDesktopShortcut'
                      Name='Tetris Synthwave'
                      Description='A modern, minimal, synthwave-themed desktop Tetris'
                      Target='[APPLICATIONFOLDER]tetris-synthwave.exe'
                      WorkingDirectory='APPLICATIONFOLDER'
                      Icon='ApplicationIcon'
                      IconIndex='0'
                      Directory='DesktopFolder' />
            <RegistryValue Root='HKCU' 
                          Key='Software\Microsoft\TetrisSynthwave' 
                          Name='installed' 
                          Type='integer' 
                          Value='1' 
                          KeyPath='yes' />
          </Component>
        </Directory>
      </Directory>
      
      <Directory Id='ProgramMenuFolder' Name='Programs' />
      <Directory Id='DesktopFolder' Name='Desktop' />
    </Directory>

    <Feature Id='Binaries'>
      <ComponentRef Id='binary0' />
      <ComponentRef Id='ApplicationShortcut' />
    </Feature>

    <WixVariable Id='WixUILicenseRtf' Value='wix/LICENSE.rtf' />
    <Property Id='WIXUI_INSTALLDIR' Value='APPLICATIONFOLDER' />
    <UIRef Id='WixUI_InstallDir' />
    
  </Product>
</Wix>
